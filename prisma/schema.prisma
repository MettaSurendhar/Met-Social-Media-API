generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// TODO: Create your schema here

// model Example {
//   id        String      @id @default(uuid())
//   createdAt DateTime @default( now())
//   updatedAt DateTime @updatedAt
//   name      String
// }

model User {
  id             String   @id @default(uuid())
  userName       String   @unique
  email          String   @unique
  passwordHashed String
  registeredAt   DateTime @default(now())
  lastLogin      DateTime @updatedAt
  role           role     @default(BASIC)

  post               Post[]
  fromUserFollowship UserFollowship[] @relation("fromUser")
  toUserFollowship   UserFollowship[] @relation("toUser")
  commentOn          Comment[]        @relation("commentedOn")
  commentBy          Comment[]        @relation("commentedBy")
  saveBy             Save[]           @relation("savedBy")
  saveOn             Save[]           @relation("savedOn")
  reactOn            Reaction[]       @relation("reactedOn")
  reactby            Reaction[]       @relation("reactedBy")
  profile            Profile?
  course             Course[]
  location           Location?

  @@index([email, userName])
}

model UserFollowship {
  id         String   @id @default(uuid())
  isAccepted Boolean  @default(false)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  fromUSer   User     @relation("fromUser", fields: [fromUserId], references: [id])
  toUser     User     @relation("toUser", fields: [toUserId], references: [id])
  fromUserId String
  toUserId   String
}

model Profile {
  id             String   @id @default(uuid())
  firstName      String
  middleName     String
  lastName       String
  userType       String
  departmentName String
  registerNo     Int      @unique
  birthDate      DateTime
  gender         String
  age            Int
  createdBy      User     @relation(fields: [userId], references: [id])
  userId         String   @unique

  Course Course[]
  about  About?

  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  Location  Location?
  Image     Image[]
  Document  Document[]
  Link      Link[]
}

model Location {
  id           String  @id @default(uuid())
  addressline1 String
  addressline2 String
  city         String
  state        String
  country      String
  postalcode   String
  nationality  String
  contactNo    String
  belongsTo    Profile @relation(fields: [profileId], references: [id])
  relatedTo    User    @relation(fields: [userId], references: [id])
  profileId    String  @unique
  userId       String  @unique
}

model Post {
  id              String     @id @default(uuid())
  postDescription String
  postType        String
  createdAt       DateTime   @default(now())
  updatedAt       DateTime   @updatedAt
  createdBy       User       @relation(fields: [userId], references: [id])
  userId          String
  Image           Image[]
  Document        Document[]
  Link            Link[]
  Comment         Comment[]
  Save            Save[]
  Reaction        Reaction[]
  about           About?
}

model Course {
  id                String   @id @default(uuid())
  courseName        String
  courseDescrpt     String
  startDate         DateTime
  endDate           DateTime
  timePeriod        Int
  instituteName     String
  instituteLocation String
  isRemote          Boolean
  belongsTo         Profile  @relation(fields: [profileId], references: [id])
  relatedTo         User     @relation(fields: [userId], references: [id])
  profileId         String
  userId            String
}

model About {
  id               String   @id @default(uuid())
  profileAbout     String   @db.Text
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  isPost           Boolean
  postAbout        String
  postBelongsTo    Post     @relation(fields: [postId], references: [id])
  profileBelongsTo Profile  @relation(fields: [profileId], references: [id])
  profileId        String   @unique
  postId           String   @unique
}

model Image {
  id               String   @id @default(uuid())
  isPost           Boolean
  isBanner         Boolean
  imageExtention   String
  imageType        String
  imageValue       String
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  postBelongsTo    Post     @relation(fields: [postId], references: [id])
  profileBelongsTo Profile  @relation(fields: [profileId], references: [id])
  postId           String
  profileId        String
}

model Document {
  id               String   @id @default(uuid())
  isPost           Boolean
  docExtention     String
  docType          String
  docTitle         String
  docValue         String
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  postBelongsTo    Post     @relation(fields: [postId], references: [id])
  profileBelongsTo Profile  @relation(fields: [profileId], references: [id])
  postId           String
  profileId        String
}

model Link {
  id               String   @id @default(uuid())
  isPost           Boolean
  linkName         String
  linkUrl          String
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  postBelongsTo    Post     @relation(fields: [postId], references: [id])
  profileBelongsTo Profile  @relation(fields: [profileId], references: [id])
  postId           String
  profileId        String
}

model Comment {
  id                String    @id @default(uuid())
  commentBody       String    @db.Text
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  userCommentedOn   User      @relation("commentedOn", fields: [commentedOnId], references: [id])
  commentedByUserId User      @relation("commentedBy", fields: [commentedById], references: [id])
  postCommentedOn   Post      @relation(fields: [postId], references: [id])
  //  commentsRelatedToUser RelatedComments[]
  //  commentsRelatedToPosts RelatedComments[]
  commentedOnId     String
  commentedById     String
  postId            String
  replyOnComment    Comment   @relation("repliedOn", fields: [commentId], references: [id])
  commentId         String
  comment           Comment[] @relation("repliedOn")
}

model Reaction {
  id              String   @id @default(uuid())
  reactionType    String
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  //  reactionsRelatedToReactions RelatedReaction[]
  //  reactionsRelatedToUsers RelatedReaction[]
  //  reactionsRelatedToPosts RelatedReaction[]
  userReactedOn   User     @relation("reactedOn", fields: [reactedOnId], references: [id])
  reactedByUserId User     @relation("reactedBy", fields: [reactedById], references: [id])
  postReactedOn   Post     @relation(fields: [postId], references: [id])
  reactedOnId     String
  reactedById     String
  postId          String
}

model Save {
  id            String   @id @default(uuid())
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  //  savesRelatedToUsers SavesRelation[]
  //  savesRelatedToPosts SavesRelation[]
  savedByUserId User     @relation("savedBy", fields: [savedById], references: [id])
  userSavedOn   User     @relation("savedOn", fields: [savedOnId], references: [id])
  postSavedOn   Post     @relation(fields: [postId], references: [id])
  savedById     String
  savedOnId     String
  postId        String
}

enum role {
  BASIC
  ADMINK
}
